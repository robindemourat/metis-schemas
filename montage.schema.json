{
    "id": "montage",
    "title": "Montage",
    "description": "Montage used in plurishing",
    "$schema": "http://json-schema.org/draft-06/schema#",
    "type": "object",
    "properties":
    {
        "type": {
          "type": "string",
          "enum": ["montage"],
          "default": "montage",
          "editable": false
        },
        "metadata": {
          "description": "metadata of the montage",
          "type": "object",
            "properties": {
              "title": {
                "type": "string",
                "description": "Title of the montage",
                "default": ""
              },
              "creators": {
                "type": "array",
                "description": "creators of the montage",
                "default": [],
                "items": {
                  "type": "object",
                  "properties": {
                    "given": {
                      "type": "string",
                      "default": ""
                    },
                    "family": {
                      "type": "string",
                      "default": ""
                    },
                    "role": {
                      "type": "string",
                      "default": ""
                    }
                  },
                  "required": ["given", "family"]
                }
              },
              "montage_type": {
                "type": "string",
                "enum": ["micropublication", "dynamic", "static"],
                "default": "micropublication"
              },
              "description": {
                "type": "string",
                "default": ""
              }
            }
        },
        "data": {
          "default": {},
          "description": "data of the montage (depends on montage type)",
          "anyOfFrom": "metadata.montage_type",
          "anyOf": [
            { "$ref": "#/definitions/micropublication" },
            { "$ref": "#/definitions/dynamic" },
            { "$ref": "#/definitions/static" }
          ]
        }
    },
    "required": ["type", "metadata", "data"],

    "definitions": {
      "micropublication": {
        "type": "object",
        "description": "micropublication montage data properties",
         "properties": {
          "target_composition_id": {
            "type": "string",
            "description": "composition to use for building the micropublication"
          },
          "include_abstract": {
            "type": "boolean",
            "default": true,
            "description": "whether to include abstract in the micropublication"
          },
          "link": {
            "type": "string",
            "description": "the link to point to from the montage"
          }
         },
          "additionalProperties": false
      },
      "dynamic": {
        "type": "object",
        "description": "dynamic montage data properties",
         "properties": {
          "compositions": {
            "type": "array",
            "description": "compositions summary",
            "default": [],
            "items": {
              "type": "object",
              "description": "composition summonning",
              "properties": {
                "target_composition_id": {
                  "type": "string",
                  "description": "composition to summon"
                },
                "template": {
                  "type": "string",
                  "description": "template to use for displaying this composition",
                  "enum": ["article", "fullscreen"],
                  "default": "article"
                },
                "css_code": {
                  "type": "string",
                  "default": "",
                  "description": "local css for that composition"
                }
              }
            }
          },
          "css_code": {
            "type": "string",
            "default": "",
            "description": "global css code for the montage"
          }
         },
          "additionalProperties": false
      },
      "static": {
        "type": "object",
        "description": "static montage data properties",
        "properties": {
          "cover_color": {
            "type": "string",
            "default": "#FFFFFF",
            "description": "color of the cover for the montage"
          },
          "compositions": {
            "type": "array",
            "description": "compositions summary",
            "items": {
              "type": "object",
              "description": "composition summonning",
              "default": {},
              "properties": {
                "target_composition_id": {
                  "type": "string",
                  "description": "composition to summon"
                },
                "template": {
                  "type": "string",
                  "description": "template to use for displaying this composition",
                  "enum": ["article"],
                  "default": "article"
                }
              }
            }
          },
          "colophon": {
            "type": "string",
            "default": "",
            "description": "colophon of the montage"
          },
          "css_code": {
            "type": "string",
            "default": "",
            "description": "global css code for the montage"
          }
         },
          "additionalProperties": false
      }
    }
}
